<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>KPR Monitoring App</title>
  <meta name="description" content="KPR Wildlife Monitoring System">

  <!-- Base href must match your deployment path -->
  <base href="/KPR_PWA_TEST/docs/">

  <!-- Mobile & iOS meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="theme-color" content="#0175C2">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="KPR Monitor">
  <link rel="apple-touch-icon" href="icons/KPR_icon.png">

  <!-- PWA manifest -->
  <link rel="manifest" href="manifest.json">

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="icons/KPR_icon.png"/>

  <!-- iOS input fix -->
  <style>
    html, body {
      height: 100%;
      width: 100%;
      margin: 0;
      padding: 0;
      -webkit-user-select: auto;
      -webkit-touch-callout: default;
      touch-action: manipulation;
      overflow: hidden;
    }
    input, textarea, select {
      -webkit-user-select: text;
      -webkit-touch-callout: default;
    }
  </style>

  <!-- Firebase SDKs -->
  <script type="module" src="firebase-config.js"></script>
  <script type="module" src="auth-service.js"></script>
  <script type="module" src="auth-ui.js"></script>
  <script type="module" src="auth-controller.js"></script>
</head>

<body>
  <!-- Flutter Web bootstrap -->
  <script src="flutter_bootstrap.js" id="flutter-bootstrap-script"></script>

  <!-- Service worker registration for offline support -->
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('flutter_service_worker.js')
        .then(() => console.log('Service worker registered'))
        .catch(err => console.error('Service worker registration failed:', err));
    }

    // iOS keyboard focus fix
    document.querySelectorAll('input, textarea').forEach(el => {
      el.addEventListener('touchstart', () => el.focus(), { passive: true });
    });
  </script>
</body>
</html>
